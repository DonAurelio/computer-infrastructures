- name: Add an Apt signing key, uses whichever key is at the URL
  apt_key:
    url: https://nvidia.github.io/nvidia-docker/gpgkey
    state: present

- name: Add nvidia-docker source list
  shell: |
    curl -s -L https://nvidia.github.io/nvidia-docker/$(. /etc/os-release;echo $ID$VERSION_ID)/nvidia-docker.list | \
    sudo tee /etc/apt/sources.list.d/nvidia-docker.list

- name: Update ubuntu
  apt: update_cache=yes

- name: Install required packages (please, be pacient ...)
  apt:
    pkg:
     - nvidia-docker2=2.0.3+docker18.06.1-1
     - nvidia-container-runtime=2.0.0+docker18.06.1-1
    state: present

- name: Reboot and wait for reboot to complete
  reboot: